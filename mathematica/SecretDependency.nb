(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     76826,       1909]
NotebookOptionsPosition[     74312,       1857]
NotebookOutlinePosition[     74744,       1874]
CellTagsIndexPosition[     74701,       1871]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Secret dependency", "Title",
 CellChangeTimes->{{3.946638105464694*^9, 
  3.9466381229824266`*^9}},ExpressionUUID->"de4fcf80-65e8-4d6a-9597-\
33e87e3611d4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Environment", "[", "\"\<MOSEKLM_LICENSE_FILE\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.927110803305202*^9, 3.9271108033056803`*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"acf8f494-71ca-4bbe-bc05-a5ea80253e0a"],

Cell[BoxData["\<\":/home/cica/mosek/mosek.lic\"\>"], "Output",
 CellChangeTimes->{
  3.927110806191057*^9, {3.92711257920789*^9, 3.927112608144987*^9}, 
   3.9273814520224257`*^9, 3.927381541061346*^9, {3.927841770730364*^9, 
   3.9278417927051973`*^9}, {3.927857998660213*^9, 3.927858009422402*^9}, 
   3.928010731349497*^9, 3.9280108229771137`*^9, {3.928918687805253*^9, 
   3.928918709028661*^9}, {3.929437982243778*^9, 3.929438002711261*^9}, 
   3.9294380379651203`*^9, {3.930565283465114*^9, 3.930565308894404*^9}, 
   3.9308549756222477`*^9, 3.930855061690587*^9, 3.930903062822323*^9, 
   3.9309351543136787`*^9, 3.931247658948078*^9, 3.9326297402929173`*^9, 
   3.9346266778192863`*^9, 3.935239441910976*^9, 3.9352409238480043`*^9, 
   3.935241120015514*^9, 3.93524137149116*^9, 3.9352446288282957`*^9, {
   3.935480387960175*^9, 3.935480411057804*^9}, 3.935574721402055*^9, 
   3.935840190618911*^9, 3.936948766778384*^9, 3.939128572061676*^9, 
   3.946638088894095*^9, 3.946638133666428*^9, 3.946638170880368*^9, 
   3.946977365953039*^9, 3.946981335276689*^9, 3.947017071084325*^9, 
   3.947077653981023*^9, 3.947077942568478*^9, 3.947337178959*^9},
 CellLabel->
  "Out[234]=",ExpressionUUID->"79e6d071-35c6-474d-9c01-2e1b9aeb4730"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quiet", "@", 
   RowBox[{
   "Import", "[", "\"\</home/cica/programs/QuESTlink/Link/QuESTlink.m\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateLocalQuESTEnv", "[", "\"\<quest_link_cpu\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\</home/cica/programs/VQD/vqd.wl\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<QuESTLinkConvention.wl\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.9219202935507936`*^9, 3.921920295331059*^9}, {
  3.921920340079768*^9, 3.921920340267742*^9}, {3.923647346642317*^9, 
  3.9236473502949667`*^9}, {3.930565267105118*^9, 3.9305652800003347`*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"7b581cf8-1eb4-45f6-9ddd-f381538221b3"],

Cell[CellGroupData[{

Cell["Data handling", "Section",
 CellChangeTimes->{{3.9466395730909243`*^9, 
  3.946639577567955*^9}},ExpressionUUID->"04372990-c457-469b-a625-\
6b4f32519aad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"formatSCounts", "[", "countl_", "]"}], " ", ":=", " ", 
   RowBox[{"With", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nshot", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ListQ", "@", "countl"}], ",", " ", 
          RowBox[{"Total", " ", "@", " ", 
           RowBox[{"countl", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", " ", "2"}], "]"}], "]"}]}], ",", " ", 
          RowBox[{"Total", " ", "@", " ", 
           RowBox[{"Values", " ", "@", " ", "countl"}]}]}], "]"}]}], ",", " ",
        "\n", "\t", 
       RowBox[{"counts", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ListQ", " ", "@", " ", "countl"}], ",", " ", 
          RowBox[{"Association", " ", "@", " ", "countl"}], ",", " ", 
          "countl"}], "]"}]}]}], "\n", "\t", "}"}], ",", " ", "\n", "\t", 
     RowBox[{"<|", " ", 
      RowBox[{
       RowBox[{"0", " ", "->", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"counts", ",", "\"\<(0,)\>\""}], "]"}], ",", " ", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"counts", "[", "\"\<(0,)\>\"", "]"}], "/", "nshot"}], 
           "]"}], ",", " ", "0"}], "]"}]}], ",", " ", "\n", "\t", 
       RowBox[{"1", " ", "->", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"counts", ",", "\"\<(1,)\>\""}], "]"}], ",", " ", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"counts", "[", "\"\<(1,)\>\"", "]"}], "/", "nshot"}], 
           "]"}], ",", " ", "0"}], "]"}]}]}], "|>"}]}], "\n", "\t", "]"}]}], 
  "\n", "\t", "\n"}], "\n", 
 RowBox[{
  RowBox[{"keyCheck", "[", 
   RowBox[{"ass_", ",", " ", "key_"}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"ass", ",", " ", "key"}], "]"}], ",", " ", 
    RowBox[{"ass", "[", "key", "]"}], ",", " ", "0"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"singleQTomography", "::", "usage"}], " ", "=", " ", 
   "\"\<singleQTomography[data]. Estimate single density matrix from Pauli \
measurements. Argument data has format of  <|``X``\[Rule] \
<|0\[Rule]\!\(\*SubscriptBox[\(p\), \(0\)]\), \
1\[Rule]\!\(\*SubscriptBox[\(p\), \(1\)]\)|>, ``Y``\[Rule].. ``Z``\[Rule].. \
|>\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"singleQTomography", "[", "data_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rx", ",", " ", "ry", ",", " ", "rz", ",", " ", "norm"}], "}"}],
      "\n", "\t", ",", " ", "\n", "\t", 
     RowBox[{
      RowBox[{"rz", " ", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"keyCheck", "[", 
           RowBox[{
            RowBox[{"data", "[", "\"\<Z\>\"", "]"}], ",", " ", "0"}], "]"}], 
          " ", "-", " ", 
          RowBox[{"keyCheck", "[", 
           RowBox[{
            RowBox[{"data", "[", "\"\<Z\>\"", "]"}], ",", " ", "1"}], "]"}]}],
          ")"}]}]}], ";", "\n", "\t", 
      RowBox[{"rx", " ", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"keyCheck", "[", 
           RowBox[{
            RowBox[{"data", "[", "\"\<X\>\"", "]"}], ",", " ", "0"}], "]"}], 
          " ", "-", " ", 
          RowBox[{"keyCheck", "[", 
           RowBox[{
            RowBox[{"data", "[", "\"\<X\>\"", "]"}], ",", " ", "1"}], "]"}]}],
          ")"}]}]}], ";", "\n", "\t", 
      RowBox[{"ry", " ", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"keyCheck", "[", 
           RowBox[{
            RowBox[{"data", "[", "\"\<Y\>\"", "]"}], ",", " ", "0"}], "]"}], 
          " ", "-", " ", 
          RowBox[{"keyCheck", "[", 
           RowBox[{
            RowBox[{"data", "[", "\"\<Y\>\"", "]"}], ",", " ", "1"}], "]"}]}],
          ")"}]}]}], ";", "\n", "\t", 
      RowBox[{"norm", " ", "=", " ", 
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rz", ",", " ", "rx", ",", " ", "ry"}], "}"}], ",", " ", 
         "2"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"rz", " ", "=", " ", 
       RowBox[{"rz", "/", "norm"}]}], ";", "\n", "\t", 
      RowBox[{"ry", " ", "=", " ", 
       RowBox[{"ry", "/", "norm"}]}], ";", "\n", "\t", 
      RowBox[{"rx", " ", "=", " ", 
       RowBox[{"rx", "/", "norm"}]}], ";", "\n", "\t", 
      RowBox[{".5", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", " ", "+", " ", "rz"}], ",", " ", 
           RowBox[{"rx", " ", "-", " ", 
            RowBox[{"\[ImaginaryI]", " ", "ry"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rx", " ", "+", " ", 
            RowBox[{"\[ImaginaryI]", " ", "ry"}]}], ",", " ", 
           RowBox[{"1", " ", "-", " ", "rz"}]}], "}"}]}], "}"}]}]}]}], "\n", 
    "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fidSingle", "[", 
    RowBox[{"\[Rho]mat_", ",", " ", "state_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Re", "[", " ", 
    RowBox[{
     RowBox[{"Conjugate", "[", "state", "]"}], " ", ".", " ", "\[Rho]mat", 
     " ", ".", " ", "state"}], " ", "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TomographyResult", "::", "usage"}], "=", 
   "\"\<TomographyResult[result_from_experiment:<|'description'\[Rule] \
<|'angle'\[Rule] \[Theta], 'basis_prepare'\[Rule] XY|>, 'counts'\[Rule] \
<|(0,)\[Rule]\!\(\*SubscriptBox[\(count\), \(0\)]\), \
(1,)\[Rule]\!\(\*SubscriptBox[\(count\), \(1\)]\)|>|>]. \nSummarise \
tomography result data into {\[Theta], \!\(\*TemplateBox[{\"\[Theta]\"},\"Ket\
\"]\), \!\(\*SubscriptBox[\(\[Rho]\), \(tomography\)]\)}.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TomographyResult", "[", "results_List", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "resultsSorted", ",", " ", "param", ",", " ", "list", ",", " ", "pauli",
        ",", " ", "expv", ",", " ", "expres", ",", " ", "\[Rho]exp", ",", " ",
        "plane", ",", " ", "\[Psi]ideal", ",", " ", "\[Theta]", ",", " ", 
       "desc"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"resultsSorted", " ", "=", " ", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"res", " ", "/.", " ", 
            RowBox[{"a_List", " ", ":>", " ", 
             RowBox[{"Association", " ", "@", " ", "a"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"res", ",", " ", 
             RowBox[{"DeleteDuplicatesBy", "[", 
              RowBox[{"results", ",", " ", 
               RowBox[{
                RowBox[{"#", "[", "\"\<handle\>\"", "]"}], "&"}]}], "]"}]}], 
            "}"}]}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", "\"\<description\>\"", "]"}], "[", 
           "\"\<angle\>\"", "]"}], "&"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"pauli", " ", "=", " ", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", "#", "]"}], " ", "->", " ", 
           RowBox[{"CalcCircuitMatrix", "[", 
            SubscriptBox["#", "0"], "]"}]}], "&"}], " ", "/@", " ", 
         RowBox[{"{", 
          RowBox[{"X", ",", " ", "Y", ",", " ", "Z"}], "}"}]}], "]"}]}], ";", 
      "\n", "\t", 
      RowBox[{"expres", " ", "=", " ", 
       RowBox[{"Table", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"param", " ", "=", " ", 
           RowBox[{"angle", "/", "4"}]}], ";", "\n", "\t\t", 
          RowBox[{"list", " ", "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"resultsSorted", ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", "\"\<description\>\"", "]"}], "[", 
                "\"\<angle\>\"", "]"}], " ", "==", " ", "param"}], " ", 
              "&"}]}], " ", "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"expres", " ", "=", " ", 
           RowBox[{"Association", " ", "@", " ", 
            RowBox[{"Table", "[", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"res", "[", "\"\<description\>\"", "]"}], "[", 
                "\"\<basis_measure\>\"", "]"}], " ", "->", " ", 
               RowBox[{"formatSCounts", " ", "@", " ", 
                RowBox[{"res", "[", "\"\<counts\>\"", "]"}]}]}], "\n", "\t\t",
               ",", 
              RowBox[{"{", 
               RowBox[{"res", ",", " ", "list"}], "}"}]}], "]"}]}]}], ";", 
          "\n", "\t", 
          RowBox[{"\[Rho]exp", " ", "=", " ", 
           RowBox[{"singleQTomography", " ", "@", " ", "expres"}]}], " ", ";",
           "\n", "\t", 
          RowBox[{"plane", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "list", "]"}], "[", "\"\<description\>\"", 
             "]"}], "[", "\"\<basis_prepare\>\"", "]"}]}], ";", "\n", "\t", 
          RowBox[{"\[Psi]ideal", " ", "=", " ", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"plane", " ", "==", " ", "\"\<XY\>\""}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                FractionBox["1", 
                 SqrtBox["2"]], ",", 
                FractionBox[
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryI]", "*", "\[Theta]"}]], 
                 SqrtBox["2"]]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 FractionBox["\[Theta]", "2"], "]"}], ",", 
                RowBox[{
                 RowBox[{"-", "\[ImaginaryI]"}], " ", 
                 RowBox[{"Sin", "[", 
                  FractionBox["\[Theta]", "2"], "]"}]}]}], "}"}]}], "]"}], 
            " ", "/.", " ", 
            RowBox[{"\[Theta]", " ", "->", " ", 
             RowBox[{"param", " ", "*", " ", "\[Pi]"}]}]}]}], ";", "\n", "\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"param", " ", "*", " ", "\[Pi]"}], ",", " ", 
            RowBox[{"KroneckerProduct", "[", 
             RowBox[{"\[Psi]ideal", ",", " ", 
              RowBox[{"Conjugate", " ", "@", " ", "\[Psi]ideal"}]}], "]"}], 
            ",", " ", "\[Rho]exp"}], "}"}]}], "\t", "\n", "\t", ",", " ", 
         RowBox[{"{", 
          RowBox[{"angle", ",", " ", "0", ",", " ", "7"}], "}"}]}], 
        "]"}]}]}]}], "\n", "]"}]}], "\n", "\n"}], "\n", 
 RowBox[{"ClearAll", "[", "hermitianTemplate", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"hermitianTemplate", "::", "usage"}], "=", 
   "\"\<hermitianTemplate[dim, variable(or {diag, real, imag}), \
[init_matrix]]. \nCreate template for hermitian matrix. Returns {hermitian \
template, elements, elements_constraints, initial values} with initial value \
as unnormalized bell state |00>+|11>. Note that the resulting hermitian \
operator is in choi form.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hermitianTemplate", "[", 
    RowBox[{"n_", ",", " ", "var_Symbol"}], "]"}], " ", ":=", " ", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "hmat", ",", " ", "elems", ",", " ", "initvals", ",", " ", "symbols", 
       ",", " ", "elemconst", ",", " ", "initmat"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"hmat", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"var", ",", " ", "##"}], "]"}], "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"n", ",", " ", "n"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
      "\n", "\t\t", 
      RowBox[{"elemconst", " ", "=", " ", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"0", " ", "<=", " ", 
          SubscriptBox["var", 
           RowBox[{"i", ",", "i", " "}]], "<=", " ", "1"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"Table", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Table", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"hmat", "[", 
             RowBox[{"[", 
              RowBox[{"col", ",", " ", "row"}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{"Conjugate", "[", 
             RowBox[{"Subscript", "[", 
              RowBox[{"var", ",", " ", "row", ",", " ", "col"}], "]"}], 
             "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"elemconst", ",", " ", 
             RowBox[{
              RowBox[{"Abs", "[", 
               SubscriptBox["var", 
                RowBox[{"row", ",", "col"}]], "]"}], " ", "<=", " ", "1"}]}], 
            "]"}]}], "\n", "\t\t\t", ",", 
          RowBox[{"{", 
           RowBox[{"col", ",", " ", 
            RowBox[{"row", "+", "1"}], ",", " ", "n"}], "}"}]}], "]"}], ",", 
        "\n", "\t\t ", 
        RowBox[{"{", 
         RowBox[{"row", ",", " ", "n"}], "}"}]}], "]"}], ";", "\n", "\t\t ", 
      "\n", "\t\t ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "identity", " ", "matrix", " ", "as", " ", "initial", " ", "value"}], 
        ";", " ", 
        RowBox[{"aka", " ", "bell", " ", "state"}]}], " ", "*)"}], "\n", 
      "\t\t", 
      RowBox[{"initmat", " ", "=", " ", 
       RowBox[{"columnShuffle", "[", 
        RowBox[{"IdentityMatrix", "[", "4", "]"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"initvals", " ", "=", " ", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"hmat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "->", " ", 
          RowBox[{"initmat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}]}], ";", " ", "\n", 
      "\t\t", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"initvals", ",", " ", 
            RowBox[{
             RowBox[{"hmat", "[", 
              RowBox[{"[", 
               RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], " ", "->", " ", 
             RowBox[{
              RowBox[{"initmat", "[", 
               RowBox[{"[", 
                RowBox[{"row", ",", " ", "col"}], "]"}], "]"}], " ", "+", " ", 
              RowBox[{"0", "  ", "\[ImaginaryI]"}]}]}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"col", ",", " ", 
            RowBox[{"row", "+", "1"}], ",", " ", "n"}], "}"}]}], "]"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"row", ",", " ", "n"}], "}"}]}], "]"}], ";", "\n", "\t\t ", 
      "\n", "\t\t", 
      RowBox[{"elems", " ", "=", " ", 
       RowBox[{"Flatten", "[", "\n", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"var", ",", " ", "#", ",", "#"}], "]"}], " ", 
              "\[Element]", " ", "Reals"}], ")"}], "&"}], " ", "/@", " ", 
           RowBox[{"Range", "[", "n", "]"}]}], ",", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"var", ",", " ", "row", ",", "col"}], "]"}], " ", 
               "\[Element]", " ", "Complexes"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"col", ",", " ", 
                RowBox[{"row", "+", "1"}], ",", " ", "n"}], "}"}]}], "]"}], 
            ",", " ", 
            RowBox[{"{", 
             RowBox[{"row", ",", " ", "n"}], "}"}]}], "]"}]}], "}"}], "\n", 
        "\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{"the", " ", "template", " ", "and", " ", "assumptions"}], " ", 
       "*)"}], "\t", "\n", "\t\t", 
      RowBox[{"{", 
       RowBox[{
       "hmat", ",", " ", "elems", ",", " ", "elemconst", ",", " ", 
        "initvals"}], "}"}]}]}], "\n", "\t", "]"}]}], "\n", "\t"}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"hermitianTemplate", "[", 
    RowBox[{"n_", ",", " ", "var_List"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "d", ",", " ", "a", ",", " ", "z", ",", " ", "superop", ",", " ", 
       "elemconst", ",", " ", "initval", ",", " ", "elems"}], "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", ",", " ", "a", ",", " ", "z"}], "}"}], " ", "=", " ", 
       "var"}], ";", "\n", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{"symbolic", " ", "superoperator"}], " ", "*)"}], "\n", "\t\t", 
      
      RowBox[{"superop", " ", "=", " ", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["d", 
            RowBox[{"#", ",", "#", " "}]], "&"}], ",", " ", 
          RowBox[{"{", "n", "}"}]}], "]"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"superop", "[", 
           RowBox[{"[", 
            RowBox[{"r", ",", " ", "c"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           SubscriptBox["a", 
            RowBox[{"r", ",", "c"}]], " ", "+", " ", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox["z", 
             RowBox[{"r", ",", "c"}]]}]}]}], ";", "\[IndentingNewLine]", 
         "\t\t\t", 
         RowBox[{
          RowBox[{"superop", "[", 
           RowBox[{"[", 
            RowBox[{"c", ",", " ", "r"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           SubscriptBox["a", 
            RowBox[{"r", ",", "c"}]], " ", "-", " ", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox["z", 
             RowBox[{"r", ",", "c"}]]}]}]}]}], "\n", "\t\t\t", ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", " ", "n"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"c", ",", " ", 
          RowBox[{"r", "+", "1"}], ",", " ", "n"}], "}"}]}], "]"}], ";", "\n",
       "\t\t\t", "\n", "\t\t", 
      RowBox[{"(*", " ", "elements", " ", "*)"}], "\n", "\t\t", 
      RowBox[{"elems", " ", "=", " ", 
       RowBox[{"Flatten", " ", "@", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["d", 
              RowBox[{"i", ",", "i"}]], " ", "\[Element]", " ", "Reals"}], 
            ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["a", 
                RowBox[{"r", ",", "c"}]], " ", "\[Element]", " ", "Reals"}], 
              ",", " ", 
              RowBox[{
               SubscriptBox["z", 
                RowBox[{"r", ",", "c"}]], "  ", "\[Element]", " ", 
               "Reals"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"r", ",", " ", "n"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"c", ",", " ", 
              RowBox[{"r", " ", "+", " ", "1"}], ",", " ", "n"}], "}"}]}], 
           "]"}]}], "}"}]}]}], ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{"constraint", " ", "on", " ", "each", " ", "element"}], " ", 
       "*)"}], "\n", "\t\t", 
      RowBox[{"elemconst", " ", "=", " ", 
       RowBox[{"Flatten", "[", "\n", "\t\t\t", 
        RowBox[{"{", " ", "\n", "\t\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
          "diagonal", " ", "constraint", " ", "is", " ", "probability", " ", 
           "value"}], " ", "*)"}], "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"0", " ", "<=", " ", 
              RowBox[{"Subscript", "[", 
               RowBox[{"d", ",", " ", "#", ",", "#"}], "]"}], " ", "<=", " ", 
              "1"}], ")"}], "&"}], " ", "/@", " ", 
           RowBox[{"Range", "[", "n", "]"}]}], ",", " ", "\n", "\t\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{"off", "-", 
            RowBox[{
            "diagonal", " ", "constraint", " ", "is", " ", "complex", " ", 
             "disk", " ", "with", " ", "radius", " ", "1"}]}], " ", "*)"}], 
          "\n", "\t\t\t", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Subscript", "[", 
                   RowBox[{"a", ",", " ", "row", ",", " ", "col"}], "]"}], 
                  "2"], " ", "+", " ", 
                 SuperscriptBox[
                  RowBox[{"Subscript", "[", 
                   RowBox[{"z", ",", " ", "row", ",", " ", "col"}], "]"}], 
                  "2"]}], "]"}], " ", "<=", " ", "1"}], "\n", "\t\t\t\t", ",",
               " ", 
              RowBox[{"{", 
               RowBox[{"col", ",", " ", 
                RowBox[{"row", " ", "+", " ", "1"}], ",", " ", "n"}], "}"}]}],
              "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"row", ",", " ", "n"}], "}"}]}], "]"}]}], "\n", "\t\t\t",
          "}"}], "\n", "\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "initial", " ", "value", " ", "as", " ", "an", " ", "identity", " ", 
        "matrix"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
      RowBox[{"initval", " ", "=", " ", 
       RowBox[{"Association", " ", "@", " ", 
        RowBox[{"Flatten", "[", "\n", "\t\t\t", 
         RowBox[{"{", " ", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"d", ",", " ", "#", ",", " ", "#"}], "]"}], " ", "->", 
              " ", "0"}], " ", "&"}], "  ", "/@", " ", 
            RowBox[{"Range", "[", "n", "]"}]}], ",", " ", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"a", ",", " ", "row", ",", " ", "col"}], "]"}], " ", 
                "->", " ", "0"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"col", ",", " ", 
                 RowBox[{"row", " ", "+", " ", "1"}], ",", " ", "n"}], 
                "}"}]}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"row", ",", " ", "n"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"z", ",", " ", "row", ",", " ", "col"}], "]"}], " ", 
                "->", " ", "0"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"col", ",", " ", 
                 RowBox[{"row", " ", "+", " ", "1"}], ",", " ", "n"}], 
                "}"}]}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"row", ",", " ", "n"}], "}"}]}], "]"}]}], "\n", 
          "\t\t\t", "}"}], "\n", "\t\t\t", "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"initval", "[", 
        SubscriptBox["d", 
         RowBox[{"1", ",", "1"}]], "]"}], "=", "1"}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"initval", "[", 
        SubscriptBox["d", 
         RowBox[{"4", ",", "4"}]], "]"}], "=", "1"}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"initval", "[", 
        SubscriptBox["a", 
         RowBox[{"1", ",", "4"}]], "]"}], "=", "1"}], ";", "\n", "\n", "\t\t", 
      RowBox[{"{", 
       RowBox[{
       "superop", ",", " ", "elems", ",", " ", "elemconst", ",", " ", 
        RowBox[{"Normal", " ", "@", " ", "initval"}]}], "}"}]}]}], "\t\t", 
    "\n", "\t", "]"}]}]}], "\n", 
 RowBox[{"\t"}]}], "Code",
 CellChangeTimes->{{3.946639753378615*^9, 3.946639849563444*^9}, {
   3.946639901773756*^9, 3.946639902653672*^9}, {3.946639987562825*^9, 
   3.946639988129652*^9}, {3.946640054453371*^9, 3.946640122068447*^9}, {
   3.94664071678465*^9, 3.9466408025137463`*^9}, {3.946640848516572*^9, 
   3.946641054790504*^9}, {3.9466411330711117`*^9, 3.946641223625622*^9}, {
   3.94664126640993*^9, 3.9466413067323933`*^9}, {3.946641356488204*^9, 
   3.946641728468869*^9}, {3.946641761562564*^9, 3.946641763247139*^9}, {
   3.946642603116952*^9, 3.946642612071604*^9}, {3.946642667739674*^9, 
   3.946642683371369*^9}, 3.946642773659815*^9, {3.946642898061447*^9, 
   3.94664292768227*^9}, {3.946642958375787*^9, 3.946643045478901*^9}, {
   3.94664308694736*^9, 3.94664317506112*^9}, {3.9466440420828876`*^9, 
   3.946644217132681*^9}, {3.946644281677587*^9, 3.946644325900045*^9}, {
   3.946644623708502*^9, 3.94664466289312*^9}, {3.946644696137054*^9, 
   3.946644730281907*^9}, {3.946644774916964*^9, 3.946644781678112*^9}, {
   3.9469814257423763`*^9, 3.946981452445856*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"b01dd9b4-78e7-4c72-b60f-f128c692a953"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataExperiment", " ", "=", " ", 
   RowBox[{"Association", " ", "/@", " ", 
    RowBox[{
    "Import", "[", 
     "\"\<../verificationQuantinuum/python/data/qc_tomography_YZ.json\>\"", 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resultTomography", " ", "=", " ", 
   RowBox[{"TomographyResult", " ", "@", " ", "dataExperiment"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"MatrixForm", "@", 
        RowBox[{"N", "@", 
         RowBox[{"TraditionalForm", "@", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}]}], ",", " ", 
       RowBox[{"MatrixForm", "@", 
        RowBox[{"TraditionalForm", "@", 
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}]}], "}"}], "&"}], "/@", " ", 
    "resultTomography"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.946639655944602*^9, 3.946639692535882*^9}, {
   3.9466398796843023`*^9, 3.946639885129263*^9}, 3.946640943477355*^9, 
   3.946643083758811*^9, {3.946644925150896*^9, 3.946645022940598*^9}, {
   3.946646936010754*^9, 3.946646958992803*^9}, {3.947017284388639*^9, 
   3.9470172845176086`*^9}, {3.947077930673588*^9, 3.947077938187698*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"31457ed4-ec29-4841-b2cf-941887b5aa73"],

Cell[BoxData[
 TagBox[GridBox[{
    {"0", 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"1.`", "0.`"},
           {"0.`", "0.`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.9999531038301332`", 
            RowBox[{
             RowBox[{"-", "0.004672458914300324`"}], "-", 
             RowBox[{"0.00500620597960748`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{
             RowBox[{"-", "0.004672458914300324`"}], "+", 
             RowBox[{"0.00500620597960748`", " ", "\[ImaginaryI]"}]}], 
            "0.00004689616986680578`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     FractionBox["\[Pi]", "4"], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.8535533905932737`", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{"0.`", "\[VeryThinSpace]", "-", 
             RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}], 
            "0.14644660940672624`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.8489683881368837`", 
            RowBox[{
             RowBox[{"-", "0.002360172673389545`"}], "+", 
             RowBox[{"0.358071911305672`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{
             RowBox[{"-", "0.002360172673389545`"}], "-", 
             RowBox[{"0.358071911305672`", " ", "\[ImaginaryI]"}]}], 
            "0.15103161186311626`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     FractionBox["\[Pi]", "2"], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.5`", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.5`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{"0.`", "\[VeryThinSpace]", "-", 
             RowBox[{"0.5`", " ", "\[ImaginaryI]"}]}], "0.5`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.5094314272933269`", 
            RowBox[{"0.006736733780947789`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49986564654632487`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{"0.006736733780947789`", "\[VeryThinSpace]", "-", 
             RowBox[{"0.49986564654632487`", " ", "\[ImaginaryI]"}]}], 
            "0.4905685727066731`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     FractionBox[
      RowBox[{"3", " ", "\[Pi]"}], "4"], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.14644660940672624`", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{"0.`", "\[VeryThinSpace]", "-", 
             RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}], 
            "0.8535533905932737`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.14282886038850517`", 
            RowBox[{
             RowBox[{"-", "0.00769188783807528`"}], "+", 
             RowBox[{"0.3498136816794229`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{
             RowBox[{"-", "0.00769188783807528`"}], "-", 
             RowBox[{"0.3498136816794229`", " ", "\[ImaginaryI]"}]}], 
            "0.8571711396114948`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {"\[Pi]", 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.`", "0.`"},
           {"0.`", "1.`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.00030844312328559553`", 
            RowBox[{
             RowBox[{"-", "0.010047417363472819`"}], "+", 
             RowBox[{"0.01440129822097767`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{
             RowBox[{"-", "0.010047417363472819`"}], "-", 
             RowBox[{"0.01440129822097767`", " ", "\[ImaginaryI]"}]}], 
            "0.9996915568767144`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     FractionBox[
      RowBox[{"5", " ", "\[Pi]"}], "4"], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.14644660940672624`", 
            RowBox[{"0.`", "\[VeryThinSpace]", "-", 
             RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}], 
            "0.8535533905932737`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.1443873278518345`", 
            RowBox[{"0.01931229867471309`", "\[VeryThinSpace]", "-", 
             RowBox[{"0.35095108281289`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{"0.01931229867471309`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.35095108281289`", " ", "\[ImaginaryI]"}]}], 
            "0.8556126721481655`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     FractionBox[
      RowBox[{"3", " ", "\[Pi]"}], "2"], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.5`", 
            RowBox[{"0.`", "\[VeryThinSpace]", "-", 
             RowBox[{"0.5`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.5`", " ", "\[ImaginaryI]"}]}], "0.5`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.49798929646254597`", 
            RowBox[{
             RowBox[{"-", "0.0010053517687270102`"}], "-", 
             RowBox[{"0.4999949463135659`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{
             RowBox[{"-", "0.0010053517687270102`"}], "+", 
             RowBox[{"0.4999949463135659`", " ", "\[ImaginaryI]"}]}], 
            "0.502010703537454`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    {
     FractionBox[
      RowBox[{"7", " ", "\[Pi]"}], "4"], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.8535533905932737`", 
            RowBox[{"0.`", "\[VeryThinSpace]", "-", 
             RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}], 
            "0.14644660940672624`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     TagBox[
      TagBox[
       FormBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.8565568625641464`", 
            RowBox[{"0.013586274502908948`", "\[VeryThinSpace]", "-", 
             RowBox[{"0.3502607841359692`", " ", "\[ImaginaryI]"}]}]},
           {
            RowBox[{"0.013586274502908948`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.3502607841359692`", " ", "\[ImaginaryI]"}]}], 
            "0.14344313743585352`"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        TraditionalForm],
       TraditionalForm,
       Editable->True],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.946644950713943*^9, 3.946644954287672*^9}, {
   3.946645003189389*^9, 3.9466450233483133`*^9}, 3.9466469593411207`*^9, 
   3.946977366123088*^9, 3.946981335746334*^9, 3.947017072189485*^9, 
   3.9470172849739027`*^9, 3.947077654320609*^9, 3.947077942856741*^9, 
   3.94707800272733*^9, 3.947337179137569*^9},
 CellLabel->
  "Out[253]=",ExpressionUUID->"c13cd0dc-8edc-47ab-8dd1-32c28272a17a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["BiConvex SDP", "Section",
 CellChangeTimes->{{3.946639707657756*^9, 3.946639713308297*^9}, {
  3.9466397924921503`*^9, 3.946639793410068*^9}, {3.946640024871641*^9, 
  3.946640029918222*^9}, {3.946644900098735*^9, 3.946644939778677*^9}, {
  3.946645030489513*^9, 
  3.946645041735211*^9}},ExpressionUUID->"bb91e6a7-9fb4-4d63-ad99-\
741e73cf2235"],

Cell[BoxData[
 RowBox[{"2", " ", 
  SubscriptBox["min", "E"], " ", 
  FractionBox["1", 
   RowBox[{"|", "\[CapitalTheta]", "|"}]], 
  RowBox[{
   UnderscriptBox["\[Sum]", 
    RowBox[{"\[Theta]", "\[Element]", "\[CapitalTheta]"}]], 
   RowBox[{
    SubscriptBox["max", 
     RowBox[{"0", "<=", 
      SubscriptBox["T", "\[Theta]"], "<=", "I", " "}]], "Tr", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"E", 
       RowBox[{"(", 
        RowBox[{
         TemplateBox[{"\[Theta]"},
          "Ket"], 
         TemplateBox[{"\[Theta]"},
          "Bra"]}], ")"}]}], " ", "-", " ", 
      RowBox[{
       SubscriptBox["\[Rho]", "\[Theta]"], 
       SubscriptBox["T", "\[Theta]"]}]}], ")"}]}]}]}]], "Text",
 CellChangeTimes->{{3.946645045889894*^9, 
  3.946645194683798*^9}},ExpressionUUID->"509e5db6-6aed-4a26-9338-\
2fa0b8767dcd"],

Cell["\<\
(* Explicit partial trace constraint *)
ptraceconst =  Total @ Table[ 
     \t\t\tWith[{bb = KroneckerProduct[b, IdentityMatrix[2^nq]]},
      \t\t\tConjugateTranspose[bb] . xR . bb], {b, IdentityMatrix[2]}] == \
IdentityMatrix[2^nq];\
\>", "CodeText",
 CellChangeTimes->{{3.946647568135298*^9, 
  3.9466475733422737`*^9}},ExpressionUUID->"baf86c17-5391-49b0-91f0-\
58a3c734fe15"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"objf1", "::", "usage"}], "=", 
   "\"\<Objective function for one term\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"objf1", "[", 
   RowBox[{
   "\[Rho]\[Theta]t_", ",", " ", "\[Rho]\[Theta]i_", ",", "ansatzE_", ",", 
    " ", "T\[Theta]_"}], "]"}], ":=", 
  RowBox[{"ExpandAll", "@", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{"choiOperate", "[", 
       RowBox[{"ansatzE", ",", " ", "\[Rho]\[Theta]i"}], "]"}], "]"}], "-", 
     RowBox[{"Tr", "[", 
      RowBox[{"\[Rho]\[Theta]t", ".", "T\[Theta]"}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"const1", "[", "x_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", " ", 
     UnderscriptBox["\[VectorGreaterEqual]", 
      TemplateBox[{"2"},
       "SemidefiniteConeList"]], " ", "0"}], ",", 
    RowBox[{
     RowBox[{"Tr", "[", "x", "]"}], "\[LessEqual]", "2"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars1", "[", "x_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"x", "\[Element]", 
    RowBox[{"Matrices", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}], ",", 
      TemplateBox[{},
       "Complexes"], ",", 
      RowBox[{"Symmetric", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.9467129868437157`*^9, 3.946713043238213*^9}, {
   3.9467134911764297`*^9, 3.94671359467197*^9}, 3.9467140544240713`*^9, {
   3.9467147542664623`*^9, 3.946714820324587*^9}, {3.946714985594348*^9, 
   3.9467150024810047`*^9}, {3.946715038357012*^9, 3.946715062743803*^9}, 
   3.9467151645998793`*^9, {3.946722881084167*^9, 3.946722883031007*^9}, {
   3.946722923691125*^9, 3.9467229941826963`*^9}, 3.946723522816658*^9, {
   3.946724120255076*^9, 3.946724183071031*^9}, {3.946981373449773*^9, 
   3.946981376272365*^9}, {3.946981406326376*^9, 3.9469814119469748`*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"0c097ed7-e27c-46aa-ab37-b6f6b5d44046"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res2", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.9992381532446463`", ",", 
      RowBox[{
       RowBox[{"-", "0.0017888163946017373`"}], "-", 
       RowBox[{"0.0011705726501704118`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.00039034877495048594`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.001223151966478471`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.9981195984970763`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0066701569280035854`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.0017888163946017373`"}], "+", 
       RowBox[{"0.0011705726501704118`", " ", "\[ImaginaryI]"}]}], ",", 
      "0.00034498631186549657`", ",", 
      RowBox[{
       RowBox[{"-", "0.0001980785995032016`"}], "+", 
       RowBox[{"0.00047089287597884295`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.0021294676448318666`"}], "+", 
       RowBox[{"0.002038085023488598`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.00039034877495048594`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.001223151966478471`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.0001980785995032016`"}], "-", 
       RowBox[{"0.00047089287597884295`", " ", "\[ImaginaryI]"}]}], ",", 
      "0.0007618467553111782`", ",", 
      RowBox[{"0.0017888163946007767`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.001170572650166756`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.9981195984970763`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.0066701569280035854`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.0021294676448318666`"}], "-", 
       RowBox[{"0.002038085023488598`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.0017888163946007767`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.001170572650166756`", " ", "\[ImaginaryI]"}]}], ",", 
      "0.9996550136880963`"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.947337321662339*^9, 3.947337322962633*^9}},
 CellLabel->
  "In[496]:=",ExpressionUUID->"5fb1058a-7ad6-46e3-abf6-7fdf0b36252e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.9992381532446463`", ",", 
     RowBox[{
      RowBox[{"-", "0.0017888163946017373`"}], "-", 
      RowBox[{"0.0011705726501704118`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.00039034877495048594`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.001223151966478471`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9981195984970763`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.0066701569280035854`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.0017888163946017373`"}], "+", 
      RowBox[{"0.0011705726501704118`", " ", "\[ImaginaryI]"}]}], ",", 
     "0.00034498631186549657`", ",", 
     RowBox[{
      RowBox[{"-", "0.0001980785995032016`"}], "+", 
      RowBox[{"0.00047089287597884295`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.0021294676448318666`"}], "+", 
      RowBox[{"0.002038085023488598`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.00039034877495048594`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.001223151966478471`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.0001980785995032016`"}], "-", 
      RowBox[{"0.00047089287597884295`", " ", "\[ImaginaryI]"}]}], ",", 
     "0.0007618467553111782`", ",", 
     RowBox[{"0.0017888163946007767`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.001170572650166756`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.9981195984970763`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.0066701569280035854`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.0021294676448318666`"}], "-", 
      RowBox[{"0.002038085023488598`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.0017888163946007767`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.001170572650166756`", " ", "\[ImaginaryI]"}]}], ",", 
     "0.9996550136880963`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.947337323690268*^9},
 CellLabel->
  "Out[496]=",ExpressionUUID->"dd569520-f455-44db-b9bd-7d2d8d092bf6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"SDP", " ", "for", " ", "T\[Theta]"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Random", " ", "unitary", " ", "as", " ", "ansatz", " ", "for", " ", "E"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ansatzE", " ", "=", " ", 
     RowBox[{"RandomVariate", " ", "@", " ", 
      RowBox[{"CircularUnitaryMatrixDistribution", "@", " ", "4"}]}]}], ";"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ansatzE", "=", " ", "res2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"solT\[Theta]", " ", "=", 
       RowBox[{"Flatten", "@", " ", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"res", " ", "=", " ", 
            RowBox[{"resultTomography", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"objfT", "=", 
            RowBox[{"-", 
             RowBox[{"objf1", "[", 
              RowBox[{
               RowBox[{"res", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"res", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "ansatzE", ",", " ", 
               SubscriptBox["T\[Theta]", "j"]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"objf", "/.", "sol"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"SemidefiniteOptimization", "[", 
            RowBox[{"objfT", ",", 
             RowBox[{"const1", "[", 
              SubscriptBox["T\[Theta]", "j"], "]"}], ",", 
             RowBox[{"vars1", "[", 
              SubscriptBox["T\[Theta]", "j"], "]"}], ",", " ", 
             RowBox[{"Method", "->", "\"\<MOSEK\>\""}]}], "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "8"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"SDP", " ", "for", " ", "ansatzE"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"choiOp", ",", "elems", ",", "const", ",", "initval"}], "}"}],
        " ", "=", " ", 
       RowBox[{"hermitianTemplate", "[", 
        RowBox[{"4", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xrpt", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"TensorContract", "[", 
          RowBox[{
           RowBox[{"ArrayReshape", "[", 
            RowBox[{"choiOp", ",", " ", 
             RowBox[{"{", 
              RowBox[{"2", ",", " ", "2", ",", " ", "2", ",", " ", "2"}], 
              "}"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "3"}], "}"}]}], "]"}], " ", "==", " ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"j", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"objfE", "=", 
       RowBox[{"ExpandAll", "[", 
        RowBox[{
         FractionBox["1", "8"], "*", 
         RowBox[{"Total", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"N", "@", 
             RowBox[{"objf1", "[", 
              RowBox[{
               RowBox[{"res", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"res", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "choiOp", ",", 
               RowBox[{"(", " ", 
                RowBox[{
                 SubscriptBox["T\[Theta]", 
                  RowBox[{"++", "j"}]], "/.", "solT\[Theta]"}], ")"}]}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"res", ",", "resultTomography"}], "}"}]}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solE", "=", 
       RowBox[{"SemidefiniteOptimization", "[", 
        RowBox[{"objfE", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"VectorGreaterEqual", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"choiOp", ",", " ", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<SemidefiniteCone\>\"", ",", " ", "4"}], "}"}]}], 
            "]"}], ",", "xrpt"}], "}"}], ",", "elems", ",", 
         RowBox[{"Method", "->", "\"\<MOSEK\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ansatzE", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{"choiOp", "/.", "solE"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"objfE", "/.", "solE"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"iter", ",", " ", "5"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.946645243724738*^9, 3.9466452465054913`*^9}, 
   3.9466453151288548`*^9, 3.946647342131694*^9, {3.9466473949126167`*^9, 
   3.946647529090662*^9}, {3.946647634700314*^9, 3.946647688049717*^9}, {
   3.946647738907051*^9, 3.946647778903167*^9}, {3.946647811948268*^9, 
   3.946647857065749*^9}, {3.946647887934102*^9, 3.946648032779422*^9}, {
   3.9467125141757803`*^9, 3.946712536683659*^9}, 3.946713028368024*^9, {
   3.946713067579356*^9, 3.946713081405672*^9}, {3.9467131169170513`*^9, 
   3.9467131979931297`*^9}, {3.9467132775854387`*^9, 3.946713302301087*^9}, {
   3.9467133673685904`*^9, 3.946713430895101*^9}, 3.9467134852948847`*^9, {
   3.9467139075911617`*^9, 3.946713910719613*^9}, {3.946714039313056*^9, 
   3.946714039821775*^9}, {3.946714184826871*^9, 3.946714188894288*^9}, {
   3.9467142211900787`*^9, 3.9467142381317997`*^9}, {3.9467142815455093`*^9, 
   3.946714377690402*^9}, {3.9467148344584637`*^9, 3.946714904930335*^9}, {
   3.9467149362285223`*^9, 3.94671497288877*^9}, {3.9467150851517344`*^9, 
   3.946715117854052*^9}, {3.946715168167014*^9, 3.946715398468354*^9}, {
   3.946715454954678*^9, 3.946715459009242*^9}, {3.946722813910647*^9, 
   3.946722816684366*^9}, {3.9467228994213867`*^9, 3.946722906453684*^9}, {
   3.9467230108219633`*^9, 3.946723085872468*^9}, {3.94672314534542*^9, 
   3.946723199802911*^9}, {3.9467234990677147`*^9, 3.946723527731963*^9}, {
   3.946723900233531*^9, 3.9467240660459013`*^9}, {3.946724108533839*^9, 
   3.946724111774246*^9}, 3.9467241595304728`*^9, {3.9467242332419233`*^9, 
   3.946724326766307*^9}, {3.94672438909175*^9, 3.946724395533886*^9}, {
   3.94672445105276*^9, 3.9467244911902933`*^9}, 3.946977391321306*^9, {
   3.9469774321142673`*^9, 3.946977456518211*^9}, {3.946980345696856*^9, 
   3.9469803478997183`*^9}, {3.946980575434661*^9, 3.94698080259494*^9}, {
   3.946980930651854*^9, 3.9469810226689663`*^9}, {3.946981069728395*^9, 
   3.946981205085964*^9}, {3.94698123647921*^9, 3.9469813054066668`*^9}, 
   3.946981474839087*^9, {3.946981512537404*^9, 3.946981537306156*^9}, {
   3.946981577028709*^9, 3.9469816692799797`*^9}, {3.946981827608398*^9, 
   3.946981858277466*^9}, 3.9469819189034452`*^9, 3.946981952306601*^9, {
   3.946983734518835*^9, 3.9469837359731903`*^9}, {3.9469862590083427`*^9, 
   3.9469862634725103`*^9}, {3.9473373333589087`*^9, 
   3.947337337974275*^9}},ExpressionUUID->"37258c50-cd21-4f19-898b-\
199d6fed9273"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.9999999999866455`", ",", "0.9999999999866455`", ",", 
   "0.9999999999866455`", ",", "0.9999999999866455`", ",", 
   "0.9999999999866455`"}], "}"}]], "Output",
 CellChangeTimes->{{3.9467151961487083`*^9, 3.946715221737175*^9}, 
   3.946715399727338*^9, 3.946715460935478*^9, 3.946722884906062*^9, {
   3.946723003612567*^9, 3.94672301694403*^9}, {3.946723097052909*^9, 
   3.946723097223692*^9}, 3.946723200426023*^9, 3.946723439578691*^9, {
   3.9467234996595697`*^9, 3.946723528269108*^9}, {3.9467239526415567`*^9, 
   3.9467239768026533`*^9}, {3.9467242247479687`*^9, 3.946724261149984*^9}, {
   3.946724294428059*^9, 3.946724327143367*^9}, 3.9467243962848682`*^9, {
   3.946724444028659*^9, 3.9467245168247423`*^9}, 3.946890637718627*^9, {
   3.9469773661842403`*^9, 3.946977392108429*^9}, {3.946977432615885*^9, 
   3.9469774630962067`*^9}, {3.946980579021018*^9, 3.946980700161173*^9}, {
   3.946980734686913*^9, 3.946980802985105*^9}, 3.9469809321384907`*^9, {
   3.946980963885425*^9, 3.9469810382325287`*^9}, {3.946981073029872*^9, 
   3.946981081301009*^9}, {3.946981112998987*^9, 3.946981133263575*^9}, 
   3.946981207759172*^9, {3.946981245512842*^9, 3.946981335868041*^9}, {
   3.946981467366888*^9, 3.9469816724978113`*^9}, 3.9469818588840427`*^9, 
   3.946981953254203*^9, 3.946983736791667*^9, {3.946986259758953*^9, 
   3.946986264224304*^9}, 3.947017072962173*^9, 3.9470776550933123`*^9, 
   3.947077943458043*^9, 3.94733717958628*^9},
 CellLabel->
  "Out[259]=",ExpressionUUID->"d81dcb0b-eb19-4af4-821f-8112164f03e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansatzE", " ", "=", " ", 
  RowBox[{"RandomVariate", " ", "@", " ", 
   RowBox[{"CircularUnitaryMatrixDistribution", "@", " ", "4"}]}]}]], "Input",\

 CellChangeTimes->{{3.9469835639551773`*^9, 3.946983608682885*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"1b60462d-9e52-4e06-94b2-d113f80e64ad"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.46598708694988966`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.5384194119267623`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.08558564452142882`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.15894171963576917`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.6424600444671279`"}], "+", 
      RowBox[{"0.032420362784541926`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.1965948129619225`"}], "-", 
      RowBox[{"0.08898140100129186`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.2111360995635114`"}], "+", 
      RowBox[{"0.03629597033503466`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.6595399407014986`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.5558254919479138`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.13953546878710796`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.1558583385765107`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3935883062295579`"}], "+", 
      RowBox[{"0.10721714212171447`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.26685500743275087`"}], "-", 
      RowBox[{"0.021462256135140786`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.03230976190102261`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.38010997156649196`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.12326799315868749`"}], "+", 
      RowBox[{"0.014864747795490716`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.4835320410686265`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.7304663385583833`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.6121060531644218`"}], "+", 
      RowBox[{"0.02680816860717083`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.04417760043459249`"}], "+", 
      RowBox[{"0.2756783356610755`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.5428751026237524`"}], "-", 
      RowBox[{"0.4819779109809938`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.11070064951660592`"}], "+", 
      RowBox[{"0.08594520996910346`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.946983608914609*^9, 3.946983746075794*^9, 
  3.947017073001223*^9, 3.94707765522854*^9, 3.9470779434803867`*^9, 
  3.9473371796049147`*^9},
 CellLabel->
  "Out[260]=",ExpressionUUID->"7c1d8841-31a4-496b-a51c-77b57e8f7f81"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ansatzE", " ", "=", " ", 
     RowBox[{"RandomVariate", " ", "@", " ", 
      RowBox[{"CircularUnitaryMatrixDistribution", "@", " ", "4"}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"solT\[Theta]", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Theta]", ",", "\[Rho]\[Theta]i", ",", "\[Rho]\[Theta]t"}], 
             "}"}], "=", 
            RowBox[{"resultTomography", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"objf\[Theta]", " ", "=", 
            RowBox[{
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"Tr", "[", 
                RowBox[{"choiOperate", "[", 
                 RowBox[{"ansatzE", ",", "\[Rho]\[Theta]i"}], "]"}], "]"}], 
               "*", 
               RowBox[{"Tr", "[", 
                SubscriptBox["T\[Theta]", "i"], "]"}]}], "]"}], "-", 
             RowBox[{"Re", "@", 
              RowBox[{"Tr", "[", 
               RowBox[{"\[Rho]\[Theta]t", ".", 
                SubscriptBox["T\[Theta]", "i"]}], "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"SemidefiniteOptimization", "[", 
            RowBox[{
             RowBox[{"-", "objf\[Theta]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["T\[Theta]", "i"], " ", 
                UnderscriptBox["\[VectorGreaterEqual]", 
                 TemplateBox[{"2"},
                  "SemidefiniteConeList"]], " ", "0"}], ",", 
               RowBox[{
                RowBox[{"Tr", "[", 
                 SubscriptBox["T\[Theta]", "i"], "]"}], "\[LessEqual]", 
                "2"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["T\[Theta]", "i"], "\[Element]", 
               RowBox[{"Matrices", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", "2"}], "}"}], ",", 
                 TemplateBox[{},
                  "Complexes"], ",", 
                 RowBox[{"Symmetric", "[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]}], "}"}], 
             ",", 
             RowBox[{"Method", "->", "\"\<MOSEK\>\""}]}], " ", "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "8"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"choiOp", ",", "elems", ",", "const", ",", "initval"}], "}"}],
        " ", "=", " ", 
       RowBox[{"hermitianTemplate", "[", 
        RowBox[{"4", ",", "x"}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"\.14xrpt", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"TensorContract", "[", 
          RowBox[{
           RowBox[{"ArrayReshape", "[", 
            RowBox[{"choiOp", ",", " ", 
             RowBox[{"{", 
              RowBox[{"2", ",", " ", "2", ",", " ", "2", ",", " ", "2"}], 
              "}"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "3"}], "}"}]}], "]"}], " ", "==", " ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xrpt2", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"TensorContract", "[", 
          RowBox[{
           RowBox[{"ArrayReshape", "[", 
            RowBox[{"choiOp", ",", " ", 
             RowBox[{"{", 
              RowBox[{"2", ",", " ", "2", ",", " ", "2", ",", " ", "2"}], 
              "}"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"2", ",", " ", "4"}], "}"}]}], "]"}], " ", "==", " ", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objfE", "=", 
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           FractionBox["1", "8"], "*", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\[Theta]", ",", "\[Rho]\[Theta]i", ",", "\[Rho]\[Theta]t"}], 
                "}"}], "=", 
               RowBox[{"resultTomography", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{
                RowBox[{"Tr", "[", 
                 RowBox[{"choiOperate", "[", 
                  RowBox[{"choiOp", ",", "\[Rho]\[Theta]i"}], "]"}], "]"}], 
                "*", 
                RowBox[{"Evaluate", "@", 
                 RowBox[{"Tr", "[", 
                  SubscriptBox["T\[Theta]", "i"], "]"}]}]}], "-", 
               RowBox[{"Tr", "[", 
                RowBox[{"\[Rho]\[Theta]t", ".", 
                 SubscriptBox["T\[Theta]", "i"]}], "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "8"}], "}"}]}], "]"}]}], "]"}], "/.", 
         "solT\[Theta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solE", "=", 
       RowBox[{"SemidefiniteOptimization", "[", 
        RowBox[{"objfE", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"VectorGreaterEqual", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"choiOp", ",", " ", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<SemidefiniteCone\>\"", ",", " ", "4"}], "}"}]}], 
            "]"}], ",", "xrpt", ",", "xrpt2"}], "}"}], ",", "elems", ",", 
         RowBox[{"Method", "->", "\"\<MOSEK\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ansatzE", " ", "=", " ", 
       RowBox[{"choiOp", "/.", "solE"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"objfE", "/.", "solE"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"iter", ",", "10"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9469836201893587`*^9, 3.946983715851263*^9}, {
   3.946983779058864*^9, 3.946983919039878*^9}, {3.946983950212624*^9, 
   3.946984100968566*^9}, {3.946984136142548*^9, 3.9469842229643087`*^9}, {
   3.9469842916168833`*^9, 3.946984398449751*^9}, {3.9469844486221857`*^9, 
   3.946984476168358*^9}, {3.94698454557546*^9, 3.946984636699164*^9}, {
   3.946984677206112*^9, 3.9469850381968527`*^9}, {3.946985075144456*^9, 
   3.946985115417514*^9}, {3.946985156609003*^9, 3.9469851676672297`*^9}, 
   3.946985201749112*^9, {3.9469852343135767`*^9, 3.946985340926135*^9}, {
   3.946985384729434*^9, 3.946985393029401*^9}, {3.946985424326696*^9, 
   3.946985454041448*^9}, {3.946985495942502*^9, 3.9469858383724613`*^9}, {
   3.946985911313821*^9, 3.946985912418243*^9}, 3.946986018746035*^9, {
   3.946986061147263*^9, 3.94698621690524*^9}, 3.946987747464625*^9},
 CellLabel->
  "In[261]:=",ExpressionUUID->"11db1653-9fd9-439e-b862-6aced171d9ed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.9999999882757284`", ",", "1.999999992367218`", ",", "1.999999992367218`",
    ",", "1.9999999923672183`", ",", "1.999999992367218`", ",", 
   "1.9999999923672176`", ",", "1.9999999923672176`", ",", 
   "1.9999999923672176`", ",", "1.9999999923672176`", ",", 
   "1.9999999923672176`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.946985622648953*^9, {3.946985840291091*^9, 3.9469859878086233`*^9}, {
   3.946986024159977*^9, 3.946986152001952*^9}, {3.9469862139264097`*^9, 
   3.946986217736286*^9}, 3.9469862687768507`*^9, 3.947017073487918*^9, 
   3.947077655597352*^9, 3.947077943831636*^9, 3.947337179949196*^9},
 CellLabel->
  "Out[262]=",ExpressionUUID->"68aebb38-f511-4d7a-875e-4b8b4aeb3909"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1438.5, 795.75},
WindowMargins->{{-1440, Automatic}, {Automatic, 12.75}},
Magnification:>0.6 Inherited,
FrontEndVersion->"13.3 for Linux x86 (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"257d3ad4-4e42-459e-bb5c-3d0ad43b3e5d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 162, 3, 88, "Title",ExpressionUUID->"de4fcf80-65e8-4d6a-9597-33e87e3611d4"],
Cell[CellGroupData[{
Cell[767, 29, 242, 4, 26, "Input",ExpressionUUID->"acf8f494-71ca-4bbe-bc05-a5ea80253e0a"],
Cell[1012, 35, 1243, 18, 42, "Output",ExpressionUUID->"79e6d071-35c6-474d-9c01-2e1b9aeb4730"]
}, Open  ]],
Cell[2270, 56, 911, 21, 99, "Input",ExpressionUUID->"7b581cf8-1eb4-45f6-9ddd-f381538221b3"],
Cell[CellGroupData[{
Cell[3206, 81, 160, 3, 59, "Section",ExpressionUUID->"04372990-c457-469b-a625-6b4f32519aad"],
Cell[3369, 86, 25782, 624, 2090, "Code",ExpressionUUID->"b01dd9b4-78e7-4c72-b60f-f128c692a953"],
Cell[CellGroupData[{
Cell[29176, 714, 1461, 36, 65, "Input",ExpressionUUID->"31457ed4-ec29-4841-b2cf-941887b5aa73"],
Cell[30640, 752, 15745, 444, 331, "Output",ExpressionUUID->"c13cd0dc-8edc-47ab-8dd1-32c28272a17a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46434, 1202, 352, 6, 59, "Section",ExpressionUUID->"bb91e6a7-9fb4-4d63-ad99-741e73cf2235"],
Cell[46789, 1210, 830, 26, 53, "Text",ExpressionUUID->"509e5db6-6aed-4a26-9338-2fa0b8767dcd"],
Cell[47622, 1238, 390, 9, 90, "CodeText",ExpressionUUID->"baf86c17-5391-49b0-91f0-58a3c734fe15"],
Cell[48015, 1249, 2053, 53, 101, "Input",ExpressionUUID->"0c097ed7-e27c-46aa-ab37-b6f6b5d44046"],
Cell[CellGroupData[{
Cell[50093, 1306, 2225, 50, 89, "Input",ExpressionUUID->"5fb1058a-7ad6-46e3-abf6-7fdf0b36252e"],
Cell[52321, 1358, 2123, 47, 65, "Output",ExpressionUUID->"dd569520-f455-44db-b9bd-7d2d8d092bf6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54481, 1410, 7260, 152, 427, "Input",ExpressionUUID->"37258c50-cd21-4f19-898b-199d6fed9273"],
Cell[61744, 1564, 1581, 25, 42, "Output",ExpressionUUID->"d81dcb0b-eb19-4af4-821f-8112164f03e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63362, 1594, 324, 7, 26, "Input",ExpressionUUID->"1b60462d-9e52-4e06-94b2-d113f80e64ad"],
Cell[63689, 1603, 2601, 60, 65, "Output",ExpressionUUID->"7c1d8841-31a4-496b-a51c-77b57e8f7f81"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66327, 1668, 7199, 168, 403, "Input",ExpressionUUID->"11db1653-9fd9-439e-b862-6aced171d9ed"],
Cell[73529, 1838, 743, 14, 42, "Output",ExpressionUUID->"68aebb38-f511-4d7a-875e-4b8b4aeb3909"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

